name: module-video-analysis-ccsdk

on:
  workflow_call:
    inputs:
      concept:
        description: 'ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚³ãƒ³ã‚»ãƒ—ãƒˆ'
        required: true
        type: string
      image-url:
        description: 'ç”»åƒURL'
        required: true
        type: string
      video-url:
        description: 'å‹•ç”»URL'
        required: true
        type: string
      image-prompt:
        description: 'ç”»åƒç”Ÿæˆç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ'
        required: true
        type: string
      video-prompt:
        description: 'å‹•ç”»ç”Ÿæˆç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ'
        required: true
        type: string
      branch-name:
        description: 'ãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ãƒ–ãƒ©ãƒ³ãƒå'
        required: true
        type: string
      folder-name:
        description: 'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚©ãƒ«ãƒ€å'
        required: true
        type: string
      video_index:
        description: 'å‹•ç”»ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹'
        required: false
        type: string
        default: '1'
    outputs:
      completed:
        description: 'å®Œäº†ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹'
        value: ${{ jobs.video-analysis.outputs.completed }}
    secrets:
      anthropic_api_key:
        description: 'Anthropic API Key'
        required: true
      gemini_api_key:
        description: 'Gemini API Key'
        required: false
      github_pat:
        description: 'GitHub Token'
        required: true

jobs:
  video-analysis:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    outputs:
      completed: ${{ steps.analyze-complete.outputs.completed }}
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          ref: ${{ inputs.branch-name }}
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
      
      - name: Install Claude Code SDK
        run: npm install @anthropic-ai/claude-code
          
      - name: ğŸ“Š å‹•ç”»åˆ†æã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ (Claude Code)
        id: analyze-video
        env:
          ANTHROPIC_API_KEY: ${{ secrets.anthropic_api_key }}
        run: |
          echo "::group::ğŸ“Š Video Analysis Agent Execution"
          echo "Starting at: $(date -u +%Y-%m-%dT%H:%M:%S.%3NZ)"
          
          # ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®æ§‹ç¯‰
          PROMPT="
            ğŸ“Š **å‹•ç”»åˆ†æã‚¿ã‚¹ã‚¯ - Gemini Vision ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**
            
            **ã‚¿ã‚¹ã‚¯**: kamuicodeã§ç”Ÿæˆã•ã‚ŒãŸå‹•ç”»ã‚’è¦–è¦šçš„ã«åˆ†æã—ã€å“è³ªè©•ä¾¡ã‚’è¡Œã†
            
            **å…¥åŠ›ãƒ‡ãƒ¼ã‚¿**:
            - **å‹•ç”»URL**: ${{ inputs.video-url }}
            - **ç”»åƒURL**: ${{ inputs.image-url }}
            - **åŸºæœ¬ã‚³ãƒ³ã‚»ãƒ—ãƒˆ**: ${{ inputs.concept }}
            - **ç”»åƒãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**: ${{ inputs.image-prompt }}
            - **å‹•ç”»ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**: ${{ inputs.video-prompt }}
            
            **é‡è¦**: ã‚‚ã—å‹•ç”»URLãŒç©ºã¾ãŸã¯"undefined"ã®å ´åˆã¯ã€URLãŒæ­£ã—ãæ¸¡ã•ã‚Œã¦ã„ãªã„ã“ã¨ã‚’å ±å‘Šã—ã€å¯èƒ½ãªç¯„å›²ã§åˆ†æã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„
            
            **åˆ†ææ‰‹é †**:
            1. **ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ**:
               ```bash
               mkdir -p ${{ inputs.folder-name }}/analysis-${{ inputs.video_index }}
               ```
               
            2. **å‹•ç”»URLç¢ºèª**:
               - å‹•ç”»URLãŒåˆ©ç”¨å¯èƒ½ã‹ã‚’ç¢ºèª
               - ã‚‚ã—å‹•ç”»URLãŒç©ºã®å ´åˆã¯ã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‡ºåŠ›
               - URLãŒåˆ©ç”¨å¯èƒ½ãªå ´åˆã¯ã€Gemini Vision APIã§ã‚¢ã‚¯ã‚»ã‚¹
               
            3. **ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«è¦–ç‚¹ã§ã®å³æ ¼è©•ä¾¡**:
               ã‚ãªãŸã¯æ˜ åƒæ¥­ç•Œã®ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ï¼ˆåºƒå‘Šä»£ç†åº—ã®ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ã‚¿ãƒ¼ã€æ˜ åƒãƒ—ãƒ­ãƒ‡ãƒ¥ãƒ¼ã‚µãƒ¼ã€ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç›£ç£ï¼‰ã¨ã—ã¦ã€å•†ç”¨åˆ©ç”¨ã®è¦³ç‚¹ã‹ã‚‰å³ã—ãè©•ä¾¡ã—ã¦ãã ã•ã„ã€‚
               
            4. **æŠ€è¡“å“è³ªè©•ä¾¡** (1-10ç‚¹ã€8ç‚¹ä»¥ä¸Šã¯æ¥µã‚ã¦ç¨€):
               - **è§£åƒåº¦ãƒ»ç”»è³ª**: ãƒã‚¤ã‚ºã€ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚¤ã‚ºã€åœ§ç¸®ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã®æœ‰ç„¡
               - **ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¬ãƒ¼ãƒˆ**: å‹•ãã®æ»‘ã‚‰ã‹ã•ã€ãƒ•ãƒ¬ãƒ¼ãƒ è½ã¡ã®æœ‰ç„¡
               - **è‰²å†ç¾**: è‰²é£½å’Œåº¦ã€è‰²ç›¸ã®æ­£ç¢ºæ€§ã€ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å“è³ª
               - **ã‚·ãƒ£ãƒ¼ãƒ—ãƒã‚¹**: è¢«å†™ä½“ã®è¼ªéƒ­ã€ç´°éƒ¨ã®é®®æ˜ã•
               - **å®‰å®šæ€§**: æ‰‹ã¶ã‚Œã€äºˆæœŸã—ãªã„å‹•ãã€ãƒ•ãƒ¬ãƒ¼ãƒ é–“ã®ä¸€è²«æ€§
               
            5. **è¦–è¦šçš„ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆè©•ä¾¡** (1-10ç‚¹ã€7ç‚¹ä»¥ä¸Šã¯å•†ç”¨ãƒ¬ãƒ™ãƒ«):
               - **æ§‹å›³**: è¦–ç·šèª˜å°ã€ãƒãƒ©ãƒ³ã‚¹ã€ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªè¦‹æ „ãˆ
               - **ãƒ©ã‚¤ãƒ†ã‚£ãƒ³ã‚°**: ç…§æ˜ã®è³ªã€å½±ã®è¡¨ç¾ã€æ˜æš—ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆ
               - **è‰²å½©è¨­è¨ˆ**: é…è‰²ã®èª¿å’Œã€ãƒ–ãƒ©ãƒ³ãƒ‰ã‚¤ãƒ¡ãƒ¼ã‚¸ã¨ã®é©åˆæ€§
               - **å‹•ãã®ã‚¯ã‚ªãƒªãƒ†ã‚£**: è‡ªç„¶ã•ã€æ„å›³æ€§ã€è¦–è¦šçš„é­…åŠ›
               - **å…¨ä½“çš„ãªç¾æ„Ÿ**: ç¬¬ä¸€å°è±¡ã€è¦–è´è€…ã®é–¢å¿ƒç¶­æŒåŠ›
               
            6. **ã‚³ãƒ³ãƒ†ãƒ³ãƒ„é©åˆæ€§è©•ä¾¡** (1-10ç‚¹ã€æ¸›ç‚¹æ–¹å¼ã§å³æ ¼ã«):
               - **ã‚³ãƒ³ã‚»ãƒ—ãƒˆå†ç¾åº¦**: "${{ inputs.concept }}" ã®æ„å›³ã‚’æ­£ç¢ºã«è¡¨ç¾ã—ã¦ã„ã‚‹ã‹
               - **ã‚¿ãƒ¼ã‚²ãƒƒãƒˆé©åˆæ€§**: æƒ³å®šè¦–è´è€…ã«é©ã—ãŸå†…å®¹ãƒ»è¡¨ç¾ã‹
               - **ãƒ–ãƒ©ãƒ³ãƒ‰å®‰å…¨æ€§**: ç‚ä¸Šãƒªã‚¹ã‚¯ã€ä¸é©åˆ‡ãªè¡¨ç¾ã®æœ‰ç„¡
               - **ç«¶åˆå„ªä½æ€§**: é¡ä¼¼ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¨æ¯”è¼ƒã—ãŸç‹¬è‡ªæ€§
               - **ç¶™ç¶šè¦–è´æ€§**: æœ€å¾Œã¾ã§è¦‹ãŸããªã‚‹é­…åŠ›ãŒã‚ã‚‹ã‹
               
            7. **å•†ç”¨åˆ©ç”¨å¯èƒ½æ€§è©•ä¾¡** (1-10ç‚¹ã€å®Ÿéš›ã®ãƒ“ã‚¸ãƒã‚¹è¦³ç‚¹ã§):
               - **SNSåºƒå‘Šé©æ€§**: Instagramã€TikTokã€YouTubeåºƒå‘Šã¨ã—ã¦ä½¿ç”¨å¯èƒ½ã‹
               - **ä¼æ¥­PRé©æ€§**: ä¼šç¤¾ç´¹ä»‹ã€è£½å“ç´¹ä»‹å‹•ç”»ã¨ã—ã¦ä½¿ç”¨å¯èƒ½ã‹
               - **TV CMé©æ€§**: ãƒ†ãƒ¬ãƒ“CMã¨ã—ã¦æ”¾é€å¯èƒ½ãªã‚¯ã‚ªãƒªãƒ†ã‚£ã‹
               - **Webæ²è¼‰é©æ€§**: ä¼æ¥­ã‚µã‚¤ãƒˆã€LPã§ã®ä½¿ç”¨ã«è€ãˆã‚‹ã‹
               - **å°åˆ·åª’ä½“é©æ€§**: é™æ­¢ç”»ã‚­ãƒ£ãƒ—ãƒãƒ£ãŒå°åˆ·ç‰©ã§ä½¿ç”¨å¯èƒ½ã‹
               
            8. **æ”¹å–„ææ¡ˆï¼ˆå¿…é ˆï¼‰**:
               - **è‡´å‘½çš„æ¬ é™¥**: å³åº§ã«ä¿®æ­£ãŒå¿…è¦ãªå•é¡Œç‚¹
               - **å“è³ªå‘ä¸Šæ¡ˆ**: å…·ä½“çš„ãªæ”¹å–„æ–¹æ³•ã¨æœŸå¾…åŠ¹æœ
               - **ä»£æ›¿æ¡ˆ**: ã‚ˆã‚Šè‰¯ã„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã®ææ¡ˆ
               - **è¿½åŠ åˆ¶ä½œææ¡ˆ**: åŒã˜äºˆç®—ã§ã‚ˆã‚Šè‰¯ã„çµæœã‚’å¾—ã‚‹æ–¹æ³•
               
            9. **æ¥­ç•Œæ¨™æº–æ¯”è¼ƒè©•ä¾¡**:
               - **åŒä¾¡æ ¼å¸¯æ¯”è¼ƒ**: åŒã˜åˆ¶ä½œã‚³ã‚¹ãƒˆã®ä»–ç¤¾ä½œå“ã¨ã®æ¯”è¼ƒ
               - **ç«¶åˆä»–ç¤¾æ¯”è¼ƒ**: åŒæ¥­ç•Œã®å„ªç§€ãªäº‹ä¾‹ã¨ã®æ¯”è¼ƒ
               - **ãƒˆãƒ¬ãƒ³ãƒ‰é©åˆæ€§**: ç¾åœ¨ã®æ˜ åƒãƒˆãƒ¬ãƒ³ãƒ‰ã¨ã®åˆè‡´åº¦
               - **å°†æ¥æ€§**: 1å¹´å¾Œã§ã‚‚é€šç”¨ã™ã‚‹ã‚¯ã‚ªãƒªãƒ†ã‚£ã‹
               
            10. **æœ€çµ‚ã‚¸ãƒ£ãƒƒã‚¸**:
                - **ç·åˆè©•ä¾¡**: ä¸Šè¨˜å…¨é …ç›®ã‚’ç·åˆã—ãŸå³æ ¼ãªè©•ä¾¡ï¼ˆ1-10ç‚¹ã€5ç‚¹ä»¥ä¸‹ã¯ä½¿ç”¨ä¸å¯ï¼‰
                - **ä½¿ç”¨å¯å¦åˆ¤å®š**: å•†ç”¨åˆ©ç”¨å¯èƒ½/è¦ä¿®æ­£/ä½¿ç”¨ä¸å¯ã®æ˜ç¢ºãªåˆ¤å®š
                - **äºˆç®—å¯¾åŠ¹æœ**: åˆ¶ä½œã‚³ã‚¹ãƒˆã«è¦‹åˆã£ãŸä¾¡å€¤ãŒã‚ã‚‹ã‹
                - **æ¬¡å›åˆ¶ä½œã¸ã®æè¨€**: ã‚ˆã‚Šè‰¯ã„çµæœã‚’å¾—ã‚‹ãŸã‚ã®å…·ä½“çš„ã‚¢ãƒ‰ãƒã‚¤ã‚¹
               
            8. **åˆ†æçµæœã®ä¿å­˜**:
               Write tool ã‚’ä½¿ç”¨ã—ã¦è©³ç´°ãªåˆ†æãƒ¬ãƒãƒ¼ãƒˆã‚’Markdownãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ä¿å­˜ã—ã¦ãã ã•ã„ã€‚
               
               ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹: ${{ inputs.folder-name }}/analysis-${{ inputs.video_index }}/video-analysis-${{ inputs.video_index }}.md
               
               **ãƒ¬ãƒãƒ¼ãƒˆå¿…é ˆé …ç›®**:
               - å†’é ­ã«ã€Œå•†ç”¨åˆ©ç”¨å¯å¦åˆ¤å®šã€ã‚’å¤§ããè¨˜è¼‰
               - å„è©•ä¾¡é …ç›®ã®ç‚¹æ•°ã¨è©³ç´°ç†ç”±
               - å…·ä½“çš„ãªæ”¹å–„ææ¡ˆï¼ˆæœ€ä½3ã¤ï¼‰
               - æ¥­ç•Œæ¨™æº–ã¨ã®æ¯”è¼ƒ
               - æ¨å¥¨åˆ©ç”¨ã‚·ãƒ¼ãƒ³ãƒ»éæ¨å¥¨åˆ©ç”¨ã‚·ãƒ¼ãƒ³
               - åˆ¶ä½œä¼šç¤¾ã¸ã®å…·ä½“çš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
               
            **è©•ä¾¡ã®å³æ ¼æ€§ã«ã¤ã„ã¦**: 
            - **å¦¥å”ã—ãªã„**: ã€Œãã‚Œãªã‚Šã«è‰¯ã„ã€ã§ã¯ä¸ååˆ†ã€‚å•†ç”¨åˆ©ç”¨ã®è¦³ç‚¹ã§å³ã—ãè©•ä¾¡
            - **å…·ä½“çš„æŒ‡æ‘˜**: ã€Œè‰¯ã„ã€ã€Œæ‚ªã„ã€ã§ã¯ãªãã€å…·ä½“çš„ã«ã©ã®éƒ¨åˆ†ãŒã©ã†å•é¡Œã‹ã‚’æ˜è¨˜
            - **æ¯”è¼ƒè©•ä¾¡**: æ¥­ç•Œæ¨™æº–ã€ç«¶åˆä»–ç¤¾ã€éå»ã®å„ªç§€ä½œå“ã¨æ¯”è¼ƒã—ã¦è©•ä¾¡
            - **åˆ©ç”¨è€…è¦–ç‚¹**: å®Ÿéš›ã«ã“ã®å‹•ç”»ã‚’è¦‹ã‚‹äººï¼ˆé¡§å®¢ã€è¦–è´è€…ï¼‰ã®ç«‹å ´ã§è©•ä¾¡
            - **ã‚³ã‚¹ãƒˆæ„è­˜**: åˆ¶ä½œã‚³ã‚¹ãƒˆã«è¦‹åˆã£ãŸä¾¡å€¤ãŒã‚ã‚‹ã‹ã‚’å³ã—ãåˆ¤å®š
            - **æ”¹å–„å¿…é ˆ**: å•é¡Œç‚¹ã®æŒ‡æ‘˜ã ã‘ã§ãªãã€å…·ä½“çš„ãªæ”¹å–„ç­–ã‚‚å¿…é ˆ
            
            **è©•ä¾¡åŸºæº–**: 
            - 10ç‚¹: æ¥­ç•Œæœ€é«˜æ°´æº–ï¼ˆGrammyã€Cannes Lionså—è³ãƒ¬ãƒ™ãƒ«ï¼‰
            - 8-9ç‚¹: å•†ç”¨åˆ©ç”¨ã§é«˜ã„åŠ¹æœãŒæœŸå¾…ã§ãã‚‹å„ªç§€ä½œå“
            - 6-7ç‚¹: å•†ç”¨åˆ©ç”¨å¯èƒ½ã ãŒæ”¹å–„ã®ä½™åœ°ã‚ã‚Š
            - 4-5ç‚¹: è¦ä¿®æ­£ã€ç¾çŠ¶ã§ã¯ä½¿ç”¨æ¨å¥¨ä¸å¯
            - 1-3ç‚¹: ä½¿ç”¨ä¸å¯ã€ä½œã‚Šç›´ã—å¿…è¦
            
            **ä½¿ç”¨å¯èƒ½ãªãƒ„ãƒ¼ãƒ«**:
            - Read/Write/Edit: ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œ
            - Bash: ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ
            - WebFetch: å‹•ç”»URLã®å†…å®¹å–å¾—ã¨åˆ†æ"
          
          echo "ğŸš€ Starting Video Analysis Agent Claude Code CLI..."
          echo "ğŸ“ Prompt length: ${#PROMPT}"
          
          # Claude Code CLIã®å®Ÿè¡Œ
          npx @anthropic-ai/claude-code \
            --max-turns 60 \
            --verbose \
            -p "$PROMPT" || {
              echo "::error::âŒ Claude Code CLI execution failed"
              exit 1
            }
          
          echo "::endgroup::"
            
      - name: Mark analysis complete
        id: analyze-complete
        run: |
          ANALYSIS_DIR="${{ inputs.folder-name }}/analysis-${{ inputs.video_index }}"
          
          # ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª
          if [ -f "$ANALYSIS_DIR/video-analysis-${{ inputs.video_index }}.md" ]; then
            echo "âœ… å‹•ç”»åˆ†æãƒ¬ãƒãƒ¼ãƒˆä½œæˆå®Œäº†"
            echo "ğŸ“„ Analysis report preview:"
            head -20 "$ANALYSIS_DIR/video-analysis-${{ inputs.video_index }}.md"
            echo "completed=true" >> $GITHUB_OUTPUT
          else
            echo "::warning::å‹•ç”»åˆ†æãƒ¬ãƒãƒ¼ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚ç©ºã®ãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚"
            mkdir -p "$ANALYSIS_DIR"
            echo "# å‹•ç”»åˆ†æãƒ¬ãƒãƒ¼ãƒˆ - ${{ inputs.concept }}" > "$ANALYSIS_DIR/video-analysis-${{ inputs.video_index }}.md"
            echo "" >> "$ANALYSIS_DIR/video-analysis-${{ inputs.video_index }}.md"
            echo "## åˆ†ææœªå®Œäº†" >> "$ANALYSIS_DIR/video-analysis-${{ inputs.video_index }}.md"
            echo "å‹•ç”»åˆ†æãŒæ­£å¸¸ã«å®Œäº†ã—ã¾ã›ã‚“ã§ã—ãŸã€‚æ‰‹å‹•ã§ã®ç¢ºèªãŒå¿…è¦ã§ã™ã€‚" >> "$ANALYSIS_DIR/video-analysis-${{ inputs.video_index }}.md"
            echo "" >> "$ANALYSIS_DIR/video-analysis-${{ inputs.video_index }}.md"
            echo "- å‹•ç”»URL: ${{ inputs.video-url }}" >> "$ANALYSIS_DIR/video-analysis-${{ inputs.video_index }}.md"
            echo "- ç”»åƒURL: ${{ inputs.image-url }}" >> "$ANALYSIS_DIR/video-analysis-${{ inputs.video_index }}.md"
            echo "- ã‚³ãƒ³ã‚»ãƒ—ãƒˆ: ${{ inputs.concept }}" >> "$ANALYSIS_DIR/video-analysis-${{ inputs.video_index }}.md"
            echo "completed=true" >> $GITHUB_OUTPUT
          fi
          
      - name: Commit analysis results
        env:
          GH_TOKEN: ${{ secrets.github_pat }}
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          git add .
          if git diff --cached --quiet; then
            echo "No analysis files to commit"
          else
            git commit -m "ğŸ“Š Add video analysis results: ${{ inputs.concept }} (video-${{ inputs.video_index }})
            
            ğŸ¤– Generated with [Claude Code](https://claude.ai/code)
            
            Co-Authored-By: Claude <noreply@anthropic.com>"
            # ä¸¦åˆ—å®Ÿè¡Œã§ã®ç«¶åˆã‚’å›é¿ã™ã‚‹ãŸã‚ã®ãƒªãƒˆãƒ©ã‚¤å‡¦ç†
            for i in {1..3}; do
              git pull --rebase origin ${{ inputs.branch-name }} || true
              if git push origin ${{ inputs.branch-name }}; then
                echo "âœ… Push successful on attempt $i"
                break
              else
                echo "âš ï¸ Push failed on attempt $i, retrying..."
                # ãƒ©ãƒ³ãƒ€ãƒ ãªå¾…æ©Ÿæ™‚é–“ï¼ˆ1-5ç§’ï¼‰
                sleep $((RANDOM % 5 + 1))
              fi
            done
          fi